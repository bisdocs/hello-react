"use strict";(self.webpackChunklearnreact=self.webpackChunklearnreact||[]).push([[668],{3944:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});var s=t(4848),i=t(8453);const a={sidebar_position:2},o="Use State Hook",r={id:"react-hooks/use-state",title:"Use State Hook",description:"useState is a built-in react hook that allows us to add state to a functional component.",source:"@site/docs/react-hooks/use-state.md",sourceDirName:"react-hooks",slug:"/react-hooks/use-state",permalink:"/hello-react/react-hooks/use-state",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"React Hooks",permalink:"/hello-react/react-hooks/hooks-intro"},next:{title:"Use Context Hook",permalink:"/hello-react/react-hooks/use-context"}},l={},c=[{value:"Initial State",id:"initial-state",level:2},{value:"Return Values",id:"return-values",level:2},{value:"Passing Next State",id:"passing-next-state",level:2},{value:"Adding State to component",id:"adding-state-to-component",level:2},{value:"Updating Objects, Arrays in State",id:"updating-objects-arrays-in-state",level:2},{value:"Undefined State Problem",id:"undefined-state-problem",level:2},{value:"Key Points",id:"key-points",level:2},{value:"More Info",id:"more-info",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"use-state-hook",children:"Use State Hook"}),"\n",(0,s.jsxs)(n.p,{children:["useState is a built-in react hook that allows us to add ",(0,s.jsx)(n.strong,{children:"state"})," to a functional component."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["We need to import ",(0,s.jsx)(n.code,{children:"useState"})," from ",(0,s.jsx)(n.code,{children:"react"})," in the component"]}),"\n",(0,s.jsx)(n.li,{children:"The useState hook takes an initial state value as its argument and returns an array with two elements: the current state value and a function to update that state."}),"\n",(0,s.jsx)(n.li,{children:"We can use this function to update the state and trigger a re-render of the component."}),"\n",(0,s.jsx)(n.li,{children:"The naming convention for state variable is like [something, setSomething] using array destructuring."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"//Syntax\nconst [state, setState] = useState(initialState);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"initial-state",children:"Initial State"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The initial state is the value we want the state to hold initially."}),"\n",(0,s.jsx)(n.li,{children:"The value can be of any type, for functions there's a special behavior"}),"\n",(0,s.jsx)(n.li,{children:"This argument is ignored after the initial render."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function MyComponent() {\n  const [age, setAge] = useState(28);\n  const [name, setName] = useState('Taylor');\n  const [married, setMarried] = useState(false);\n  const [todos, setTodos] = useState(() => createTodos());\n  // ...\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"The initializer function"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If we pass a function as initialState, it will be treated as an initializer function."}),"\n",(0,s.jsx)(n.li,{children:"It should be pure, should take no arguments, and should return a value of any type."}),"\n",(0,s.jsx)(n.li,{children:"React will call your initializer function when initializing the component, and store its return value as the initial state."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import React, { useState } from "react";\n\nfunction InitializeDemo() {\n  const setInitialMessage = () => {\n    console.log("Initial message");\n  };\n\n  const [messageFunction, setMessageFunction] = useState(setInitialMessage);\n\n  const messageHi = () => {\n    console.log("Hi");\n  };\n\n  const messageHello = () => {\n    console.log("Hello");\n  };\n\n  const updateMessage1 = () => {\n    setMessageFunction(() => {\n      console.log("Hey");\n    });\n  };\n\n  const updateMessage2 = () => {\n    setMessageFunction(messageHi);\n  };\n\n  const updateMessage3 = () => {\n    setMessageFunction(messageHello);\n  };\n\n  return (\n    <div>\n      {messageFunction}\n      <button onClick={updateMessage1}>Update Message1</button>\n      <button onClick={updateMessage2}>Update Message2</button>\n      <button onClick={updateMessage3}>Update Message3</button>\n    </div>\n  );\n}\n\nexport default InitializeDemo;\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Avoid recreating the initial state"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"React saves the initial state once and ignores it on the next renders."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function TodoList() {\n  const [todos, setTodos] = useState(createInitialTodos());\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Although the result of ",(0,s.jsx)(n.code,{children:"createInitialTodos()"})," is only used for the initial render,"]}),"\n",(0,s.jsx)(n.li,{children:"we are still calling this function on every render."}),"\n",(0,s.jsx)(n.li,{children:"This can be wasteful if it\u2019s creating large arrays or performing expensive calculations."}),"\n",(0,s.jsx)(n.li,{children:"To solve this, you may pass it as an initializer function to useState instead"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function TodoList() {\n  const [todos, setTodos] = useState(createInitialTodos);\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Notice that we are passing ",(0,s.jsx)(n.code,{children:"createInitialTodos"}),", which is the function itself,"]}),"\n",(0,s.jsxs)(n.li,{children:["and not ",(0,s.jsx)(n.code,{children:"createInitialTodos()"})," which is the result of calling it."]}),"\n",(0,s.jsx)(n.li,{children:"If you pass a function to useState, React will only call it during initialization."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"\nfunction createInitialTodos() {\n  const initialTodos = [];\n  for (let i = 0; i < 50; i++) {\n    initialTodos.push({\n      id: i,\n      text: 'Item ' + (i + 1)\n    });\n  }\n  return initialTodos;\n}\n\n//Arroach 1: Passing the initializer function\nconst [todos, setTodos] = useState(createInitialTodos);\n\n//Approach 2: Passing the initial state directly\n//This example does not pass the initializer function, \n//so the createInitialTodos function runs on every render, \n//such as when you type into the input.\n//There is no observable difference in behavior, but this code is less efficient.\nconst [todos, setTodos] = useState(createInitialTodos());\n"})}),"\n",(0,s.jsx)(n.h2,{id:"return-values",children:"Return Values"}),"\n",(0,s.jsx)(n.p,{children:"useState returns an array with exactly two values"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"current state"}),", during the first render the value will be the initialState"]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"set function"})," that lets uss to update the state to a different value and trigger a re-render."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState } from "react";\n\nfunction Restaurants() {\n  const restlist = ["Hilton", "Mariot", "Taj"];\n\n  const rest = useState(restlist);\n\n  console.log(rest);\n  return (\n    <>\n      <p>{rest[0]}</p>\n      <p>{console.log(rest[1])}</p>\n    </>\n  );\n}\n\nexport default Restaurants;\n'})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"We will notice the useState returns array of hotel names and a function for the above example."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"passing-next-state",children:"Passing Next State"}),"\n",(0,s.jsxs)(n.p,{children:["We can pass the next state to the ",(0,s.jsx)(n.code,{children:"setState"})," function directly or a function that calculates the next state from the previous state."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"// Passing Next State directly\nsetCounter(counter+1);\n\n//Passing next state as updater function\nsetCounter(prevCounter => prevCounter+1);\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Updating the next state directly"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The state updates are asynchronous"}),"\n",(0,s.jsx)(n.li,{children:"Means React will queue all the state updates and then it will update"}),"\n",(0,s.jsxs)(n.li,{children:["When we call ",(0,s.jsx)(n.code,{children:"setCounter(counter+1)"})," three times, React will enqueue these state updates, scheduling them to be processed in the near future."]}),"\n",(0,s.jsx)(n.li,{children:"During processing, React will perform the state updates one by one, but each update will use the initial state value at the time it was added to the queue."}),"\n",(0,s.jsxs)(n.li,{children:["This means that each ",(0,s.jsx)(n.code,{children:"setCounter"})," call will use the initial ",(0,s.jsx)(n.code,{children:"counter"})," value, not the updated value from previous setCounter calls."]}),"\n",(0,s.jsxs)(n.li,{children:["Consequently, each ",(0,s.jsx)(n.code,{children:"setCounter"})," call will increment the state value by 1 from the initial value."]}),"\n",(0,s.jsx)(n.li,{children:"Therefore, the final state will be incremented by 1 and not by 3."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Updating the next state updater function"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["When we pass a function as nextState that's considered as ",(0,s.jsx)(n.code,{children:"updater function"})]}),"\n",(0,s.jsx)(n.li,{children:"It should be a pure function"}),"\n",(0,s.jsxs)(n.li,{children:["It takes only one argument i.e ",(0,s.jsx)(n.code,{children:"previous state"})]}),"\n",(0,s.jsxs)(n.li,{children:["And returns the ",(0,s.jsx)(n.code,{children:"next state"})]}),"\n",(0,s.jsx)(n.li,{children:"React will put the updater function in a queue and re-render the component."}),"\n",(0,s.jsx)(n.li,{children:"During next render, React will calculate the next state by applying all of the queued updaters to the previous state."}),"\n",(0,s.jsxs)(n.li,{children:["When we use the updater function form of ",(0,s.jsx)(n.code,{children:"setCounter"}),", it receives the previous state as an argument."]}),"\n",(0,s.jsxs)(n.li,{children:["This ensures that each call to ",(0,s.jsx)(n.code,{children:"setCounter"})," receives the latest state value as its starting point."]}),"\n",(0,s.jsx)(n.li,{children:"Therefore, even if the updates are batched together, each call will be based on the latest state"}),"\n",(0,s.jsx)(n.li,{children:"As a result it will have correct increment i.e by 3"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState } from "react";\n\nfunction NextStateDemo() {\n  const [counter, setCounter] = useState(0);\n\n  const handleIncrement1 = () => {\n    setCounter(counter + 1);\n    setCounter(counter + 1);\n    setCounter(counter + 1);\n  };\n\n  const handleIncrement2 = () => {\n    setCounter((prevCount) => prevCount + 1);\n    setCounter((prevCount) => prevCount + 1);\n    setCounter((prevCount) => prevCount + 1);\n  };\n\n  return (\n    <div>\n      <h1>{counter}</h1>\n      <button onClick={handleIncrement1}>Click</button>\n      <button onClick={handleIncrement2}>Click</button>\n    </div>\n  );\n}\n\nexport default NextStateDemo;\n'})}),"\n",(0,s.jsx)(n.h2,{id:"adding-state-to-component",children:"Adding State to component"}),"\n",(0,s.jsx)(n.p,{children:"We need to use useState at the top level of the component & can declare multiple state variables"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { useState } from 'react';\n\nfunction MyComponent() {\n  const [age, setAge] = useState(42);\n  const [name, setName] = useState('Taylor');\n"})}),"\n",(0,s.jsx)(n.p,{children:"To update the state on the screen we need to call the setState method with the next state"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function handleClick() {\n  setName('Robin');\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"React will store the next state and render the component again with the new value, then it will update the UI"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Calling the set function does not change the current state in the already executing code"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function handleClick() {\n  setName('Robin');\n  console.log(name); // Still \"Taylor\"!\n}\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The state variable ",(0,s.jsx)(n.code,{children:"name"})," will hold the updated value when useState will return the updated value in next render"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"updating-objects-arrays-in-state",children:"Updating Objects, Arrays in State"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The premitive types like string, number, boolean etc work same way"}),"\n",(0,s.jsx)(n.li,{children:"We can put non primitive types like Objects & Arrays in state"}),"\n",(0,s.jsx)(n.li,{children:"React state is considered read only, so we should replace it instead of mutating existing object"}),"\n",(0,s.jsxs)(n.li,{children:["So if we have a ",(0,s.jsx)(n.code,{children:"form"})," object"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"//Don't mutate an object in state like below\nform.firstName='Ranbir'\n\n//replace whole object by creating new\nsetForm({\n  ...form,\n  firstName: 'Bis'\n})\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Nested Object"})}),"\n",(0,s.jsx)(n.p,{children:"The nested object values can be updated this way"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"setPerson({\n      ...person,\n      address: {\n        ...person.address,\n        city: value,\n      },\n    });\n"})}),"\n",(0,s.jsx)(n.p,{children:"The complete code is given below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState } from "react";\n\nfunction NestedObjectState() {\n  const initialData = {\n    name: "Biswajit",\n    address: {\n      street: "10 Park street",\n      city: "Bangalore",\n      pin: "3211",\n    },\n  };\n\n  const [person, setPerson] = useState(initialData);\n\n  const handleNameChange = (value) => {\n    setPerson({\n      ...person,\n      name: value,\n    });\n  };\n\n  const handleCityChange = (value) => {\n    setPerson({\n      ...person,\n      address: {\n        ...person.address,\n        city: value,\n      },\n    });\n  };\n\n  return (\n    <>\n      <h1>Name: {person.name}</h1>\n      <h1>City:{person.address.city}</h1>\n      <button onClick={() => handleNameChange("John")}>Change Name</button>\n      <button onClick={() => handleCityChange("Mumbai")}>Change City</button>\n    </>\n  );\n}\n\nexport default NestedObjectState;\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Array State"})}),"\n",(0,s.jsx)(n.p,{children:"We can update the state with array as below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'setTodos([\n      ...todos,\n      {\n        id: 3,\n        title: "Walk",\n        done: false,\n      },\n    ]);\n'})}),"\n",(0,s.jsx)(n.p,{children:"The complete code is given below"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState } from "react";\n\nfunction ArrayState() {\n  const initialTodos = [\n    { id: 0, title: "Buy milk", done: true },\n    { id: 1, title: "Eat tacos", done: false },\n    { id: 2, title: "Brew tea", done: false },\n  ];\n\n  const [todos, setTodos] = useState(initialTodos);\n\n  const todoHandler = () => {\n    setTodos([\n      ...todos,\n      {\n        id: 3,\n        title: "Walk",\n        done: false,\n      },\n    ]);\n  };\n\n  return (\n    <div>\n      {todos.map((todo) => (\n        <li key={todo.id}>{todo.title}</li>\n      ))}\n\n      <button onClick={todoHandler}>Add Todo</button>\n    </div>\n  );\n}\n\nexport default ArrayState;\n'})}),"\n",(0,s.jsx)(n.p,{children:"Now if we want to perform operations like delete, edit etc"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'//delete the todo\n const deleteTodoHandler = (id) => {\n    setTodos(todos.filter((todo) => todo.id !== id));\n  };\n\n//Change the todo\nconst changeTodoHandler = (id) => {\n    setTodos(\n      todos.map((todo) => {\n        if (todo.id === id) {\n          return { id: id, title: "buy cheese",done: true};\n        } else {\n          return todo;\n        }\n      })\n    );\n  };\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"With Immer.js"})}),"\n",(0,s.jsx)(n.p,{children:"If we feel the above approaches are tedious then we can use immer.js"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Immer under the hood does the same mutation"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"import { useState } from 'react';\nimport { useImmer } from 'use-immer';\n\nconst [list, updateList] = useImmer(initialList);\n"})}),"\n",(0,s.jsx)(n.p,{children:"Refer the official doc for more info"}),"\n",(0,s.jsx)(n.h2,{id:"undefined-state-problem",children:"Undefined State Problem"}),"\n",(0,s.jsx)(n.p,{children:"Most of the times when we have undefined state and access to any value it will throw error and we will see a blank page."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:'import { useState } from "react";\n\nfunction UndefinedState() {\n  const [person, setPerson] = useState();\n\n  return (\n    <>\n      <h1>Name is {person.name}</h1>\n    </>\n  );\n}\n\nexport default UndefinedState;\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Solutions"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"//Use optional parameters\n<h1>Name is {person?.name}</h1>\n\n//Make it conditional\n{person && <h1>Name is {person.name}</h1>}\n\n//Initialize the state as blank\nuseState('');\nuseState({});\nuseState([]);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"key-points",children:"Key Points"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"useState is a hook so it can only be called at the top level of the component"}),"\n",(0,s.jsx)(n.li,{children:"If we need to call it inside any condition/loop then move the state logic to another component and use."}),"\n",(0,s.jsx)(n.li,{children:"In strict mode, React will call the initializer function twice. This behaviour is only in dev environment and doesn't impact production. Since the initializer function needs to be pure, this shouldn't affect the behaviour. The result from one of the two calls will be ignored."}),"\n",(0,s.jsx)(n.li,{children:"useState hook executes in the same order"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"useState() -- executes first\nuseState()\nuseState() -- executes last\n"})}),"\n",(0,s.jsx)(n.h2,{id:"more-info",children:"More Info"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://react.dev/reference/react/useState",children:"The useState hook"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://react.dev/learn/state-a-components-memory",children:"React State"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://react.dev/learn/updating-objects-in-state",children:"Updating objects in state"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://react.dev/learn/updating-arrays-in-state",children:"updating arrays in state"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var s=t(6540);const i={},a=s.createContext(i);function o(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);